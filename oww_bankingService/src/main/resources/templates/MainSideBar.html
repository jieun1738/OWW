<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<!-- sidebar(user, active, progress) 시그니처 유지 -->
<div th:fragment="sidebar (user, active, progress)">
  <aside class="leftnav" aria-label="웨딩플래너 사이드바">
    <!-- 상단 사용자 박스 -->
    <div class="ln-header">
      <div class="icon-box brand --xl" title="User"><i class='bx bx-user-circle'></i></div>
      <div class="ln-user">
        <div class="ln-hello" th:text="${(user != null && user.userName != null) ? user.userName + ' 님' : '반가워요!'}">반가워요!</div>
        <div class="ln-mail" th:text="${(user != null && user.userEmail != null) ? user.userEmail : ''}">user@example.com</div>
      </div>
    </div>

    <!-- 진행도 -->
    <div class="ln-progress">
      <div class="ln-title-row">
        <div class="ln-title"><i class='bx bx-target-lock'></i> 진행도</div>
        <div class="ln-pct" th:text="${progress != null ? progress + '%' : '0%'}">0%</div>
      </div>
      <div class="ln-bar">
        <div class="ln-fill" th:style="${'width:' + (progress != null ? progress : 0) + '%'}"></div>
      </div>
    </div>

    <!-- 요약(있을 때만 노출) -->
    <div class="ln-summary" th:if="${draftCount != null || productCompareCount != null || planCompareCount != null}">
      <div class="ln-kpi">
        <div class="kpi">
          <span class="icon-box --sm brand"><i class='bx bx-edit-alt'></i></span>
          <span class="t">임시 플랜</span>
          <span class="v" th:text="${draftCount != null ? draftCount : 0}">0</span>
        </div>
        <div class="kpi">
          <span class="icon-box --sm brand"><i class='bx bx-git-compare'></i></span>
          <span class="t">상품 비교함</span>
          <span class="v" th:text="${productCompareCount != null ? productCompareCount : 0}">0</span>
        </div>
        <div class="kpi">
          <span class="icon-box --sm brand"><i class='bx bx-slider-alt'></i></span>
          <span class="t">플랜 비교함</span>
          <span class="v" th:text="${planCompareCount != null ? planCompareCount : 0}">0</span>
        </div>
      </div>
    </div>

    <!-- 내비게이션 -->
    <div class="ln-title" style="margin-top:10px;">메뉴</div>
    <nav class="ln-list">
      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingPlannerInfo')}? ' active' : ''"
         th:href="@{/planner/info}">
        <i class='bx bx-home-heart'></i><span>웨딩플래너</span>
      </a>

      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingPlannerIntro')}? ' active' : ''"
         th:href="@{/planner/intro}">
        <i class='bx bx-book-open'></i><span>웨딩플래너 소개</span>
      </a>

      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingCategory')}? ' active' : ''"
         th:href="@{/planner/category}">
        <i class='bx bx-category'></i><span>테마별 패키지</span>
      </a>

      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingDIY')}? ' active' : ''"
         th:href="@{/planner/diy}">
        <i class='bx bx-wrench'></i><span>사용자 DIY</span>
      </a>

      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingPlanList')}? ' active' : ''"
         th:href="@{/planner/plan/list}">
        <i class='bx bx-collection'></i><span>플랜 보관함</span>
      </a>

      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingProductCompare')}? ' active' : ''"
         th:href="@{/planner/compare/product}">
        <i class='bx bx-git-compare'></i><span>상품 비교</span>
      </a>

      <a class="ln-item"
         th:classappend="${#strings.containsIgnoreCase(active,'WeddingPlanCompare')}? ' active' : ''"
         th:href="@{/planner/compare/plan}">
        <i class='bx bx-slider-alt'></i><span>플랜 비교</span>
      </a>
    </nav>

    <!-- 도움말 -->
    <div class="ln-help">
      <div class="icon-box --sm"><i class='bx bx-info-circle'></i></div>
      <div class="t">로그인 필요 시 접근 차단 후 로그인 페이지로 유도됩니다.</div>
    </div>
  </aside>
</div>
</body>
</html>
