<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
  <title layout:fragment="title">WeddingPlanList</title>
  <link rel="stylesheet" th:href="@{/css/WeddingPlanList.css}">
</head>
<body>
<section layout:fragment="content">
  <div class="page" id="wpplanlist">
    <div th:replace="~{fragments/MainSideBar :: sidebar(user=${user}, active='WeddingPlanner/WeddingPlanList', progress=${progressPercent})}"></div>

    <main class="content">
      <header class="page-header">
        <div>
          <h1 class="title section-title"><i class='bx bx-collection'></i>플랜 보관함</h1>
          <p class="desc">최종 확정된 플랜 목록입니다.</p>
        </div>
        <div class="quick-actions">
          <a class="btn" th:href="@{/planner/diy}"><i class='bx bx-wrench'></i> DIY로 돌아가기</a>
          <a class="btn brand" th:href="@{/planner/compare/plan}"><i class='bx bx-git-compare'></i> 비교하기</a>
        </div>
      </header>

      <section class="grid">
        <article class="card" th:each="pc : ${planCards}">
          <div class="thumb"
               th:style="|background-image:url(${#strings.containsIgnoreCase(pc.thumbnailImg,'http') ? pc.thumbnailImg : @{/img/{img}(img=${pc.thumbnailImg})}});|"></div>

          <div class="content">
            <h3 class="title">
              <span class="icon-box brand --sm"><i class='bx bx-file'></i></span>
              <span th:text="'플랜 #' + ${pc.planNo}">플랜</span>
            </h3>
            <div class="meta-row">
              <span><i class='bx bx-purchase-tag'></i> <span th:text="${pc.packageBased ? '패키지 기반' : 'DIY 기반'}">유형</span></span>
            </div>

            <div class="price-row">
              <div class="label"><i class='bx bx-calculator'></i> 총 금액</div>
              <div class="value" th:text="${#numbers.formatInteger(pc.total,3,'COMMA') + '원'}">0원</div>
            </div>

            <div class="actions">
              <form th:action="@{/planner/compare/plan/toggle}" method="post">
                <input type="hidden" name="planNo" th:value="${pc.planNo}">
                <button class="btn" type="submit"><i class='bx bx-toggle-left'></i> 비교 선택/해제</button>
              </form>
            </div>
          </div>
        </article>

        <div class="empty" th:if="${planCards == null or #lists.isEmpty(planCards)}"><i class='bx bx-info-circle'></i> 아직 확정된 플랜이 없습니다.</div>
      </section>
    </main>
  </div>
</section>
</body>
</html>
