<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
  <title layout:fragment="title">WeddingCategory</title>
  <link rel="stylesheet" th:href="@{/css/WeddingCategory.css}">
  <style>
    .cat-bar { display:flex; flex-wrap:wrap; gap:8px; margin:12px 0 20px; }
    .cat-bar .btn { padding:8px 12px; border-radius:8px; }
    .btn.active { font-weight:700; box-shadow:0 0 0 2px rgba(0,0,0,.08) inset; }
  </style>
</head>
<body>
<section layout:fragment="content">
  <div class="page" id="wpcategory">
    <div th:replace="~{fragments/MainSideBar :: sidebar(user=${user}, active='WeddingPlanner/WeddingCategory', progress=${progressPercent})}"></div>

    <main class="content">
      <header class="page-header">
        <h1 class="title section-title"><i class='bx bx-book-content'></i> 테마별 패키지</h1>
        <div class="cat-bar">
          <a class="btn" th:classappend="${type == -1} ? ' active'" th:href="@{/planner/category(type=-1)}">전체보기</a>
          <a class="btn" th:classappend="${type == 0} ? ' active'" th:href="@{/planner/category(type=0)}">가성비</a>
          <a class="btn" th:classappend="${type == 1} ? ' active'" th:href="@{/planner/category(type=1)}">프리미엄</a>
          <a class="btn" th:classappend="${type == 2} ? ' active'" th:href="@{/planner/category(type=2)}">호텔</a>
          <a class="btn" th:classappend="${type == 3} ? ' active'" th:href="@{/planner/category(type=3)}">채플</a>
          <a class="btn" th:classappend="${type == 4} ? ' active'" th:href="@{/planner/category(type=4)}">가든</a>
        </div>
      </header>

      <!-- 컨트롤러 모델키: packageList -->
      <section class="grid">
        <article class="card" th:each="p : ${packageList}">
          <div class="thumb"
               th:style="|background-image:url(${#strings.contains(p.thumbnailImg,'http') ? p.thumbnailImg : @{/img/{img}(img=${p.thumbnailImg})}});|">
            <div class="thumb-fallback" th:if="${p.thumbnailImg == null or p.thumbnailImg == ''}">
              <i class="bx bx-image-alt"></i> 패키지 이미지
            </div>
          </div>
          <div class="content">
            <h3 class="title" th:text="${p.title}">패키지 #</h3>
            <div class="price-row">
              <div class="label"><i class='bx bx-calculator'></i> 가격</div>
              <div class="value">
                <del th:text="${#numbers.formatInteger(p.totalPrice,3,'COMMA') + '원'}">0원</del>
                <b th:text="${#numbers.formatInteger(p.finalPrice,3,'COMMA') + '원'}">0원</b>
                <span class="badge" th:text="${p.discount + '%'}">0%</span>
              </div>
            </div>
            <div class="actions">
              <a class="btn" th:href="@{/planner/confirm(packageNo=${p.packageNo})}">
                <i class="bx bx-search-alt"></i> 상세/확인
              </a>
              <form th:action="@{/planner/package/confirm}" method="post">
                <input type="hidden" name="packageNo" th:value="${p.packageNo}">
                <button class="btn brand" type="submit"><i class="bx bx-badge-check"></i> 이 패키지 확정</button>
              </form>
            </div>
          </div>
        </article>

        <div class="empty" th:if="${packageList == null or #lists.isEmpty(packageList)}">
          <i class='bx bx-info-circle'></i> 표시할 패키지가 없습니다.
        </div>
      </section>
    </main>
  </div>
</section>
</body>
</html>
