<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/base}">
<head>
  <title layout:fragment="title">WeddingPlannerInfo</title>
  <link rel="stylesheet" th:href="@{/css/WeddingPlannerInfo.css}">
</head>
<body>
<section layout:fragment="content">
  <div class="page" id="wpinfo">
    <div th:replace="~{fragments/MainSideBar :: sidebar(user=${user}, active='WeddingPlanner/WeddingPlannerInfo', progress=${progressPercent})}"></div>

    <main class="content">
      <header class="page-header">
        <div>
          <h1 class="title section-title"><i class='bx bx-home-heart'></i> 웨딩플래너 현황</h1>
          <p class="desc">진행 요약과 추천 패키지를 확인하세요.</p>
        </div>
        <div class="actions">
          <a class="btn" th:href="@{/planner/diy}"><i class='bx bx-wrench'></i> DIY</a>
          <a class="btn" th:href="@{/planner/category}"><i class='bx bx-book-content'></i> 테마별 패키지</a>
          <a class="btn" th:href="@{/planner/plan/list}"><i class='bx bx-collection'></i> 플랜 보관함</a>
        </div>
      </header>

      <!-- 추천 패키지(컨트롤러 모델 키: recommendedPackages) -->
      <section class="grid">
        <div class="card" th:each="pkg : ${recommendedPackages}">
          <div class="thumb"
               th:style="|background-image:url(${#strings.contains(pkg.thumbnailImg,'http') ? pkg.thumbnailImg : @{/img/{img}(img=${pkg.thumbnailImg})}});|">
            <div class="thumb-fallback" th:if="${pkg.thumbnailImg == null or pkg.thumbnailImg == ''}">
              <i class='bx bx-image-alt'></i> 이미지가 없음
            </div>
          </div>
          <div class="content">
            <h3 class="title" th:text="${pkg.title}">패키지 #</h3>
            <div class="price-row">
              <div class="label"><i class='bx bx-calculator'></i> 가격</div>
              <div class="value">
                <del th:text="${#numbers.formatInteger(pkg.totalPrice,3,'COMMA') + '원'}">0원</del>
                <b th:text="${#numbers.formatInteger(pkg.finalPrice,3,'COMMA') + '원'}">0원</b>
                <span class="badge" th:text="${pkg.discount + '%'}">0%</span>
              </div>
            </div>
            <div class="actions">
              <a class="btn" th:href="@{/planner/confirm(packageNo=${pkg.packageNo})}">
                <i class='bx bx-search-alt-2'></i> 미리보기
              </a>
              <form th:action="@{/planner/package/confirm}" method="post">
                <input type="hidden" name="packageNo" th:value="${pkg.packageNo}">
                <button class="btn brand" type="submit"><i class='bx bx-badge-check'></i> 이 패키지 확정</button>
              </form>
            </div>
          </div>
        </div>

        <div class="empty" th:if="${recommendedPackages == null or #lists.isEmpty(recommendedPackages)}">
          <i class='bx bx-info-circle'></i> 추천 패키지가 없습니다.
        </div>
      </section>
    </main>
  </div>
</section>
</body>
</html>
