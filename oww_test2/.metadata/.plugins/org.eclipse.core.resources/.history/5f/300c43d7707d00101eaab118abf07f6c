// ========================================
// 인증 관련 함수들
// ========================================

// 로그인 함수
function login() {
    window.location.href = '/auth/oauth2/authorization/google';
}

// 로그아웃 함수
function logout() {
    deleteCookie('jwt-token');
    showLoggedOutState();
    updateUserInfo('사용자', 'user@example.com');
}

// 로그인 상태 확인
function checkLoginStatus() {
    const urlParams = new URLSearchParams(window.location.search);
    const loginSuccess = urlParams.get('login');

    if (loginSuccess) {
        window.history.replaceState({}, document.title, window.location.pathname);
    }

    const token = getCookie('jwt-token');
    if (token) {
        showLoggedInState();
        try {
            const payloadStr = b64DecodeUnicode(token.split('.')[1]);
            const payload = JSON.parse(payloadStr);
            const userName = payload.name || payload.username || '사용자';
            const userEmail = payload.email || payload.sub || 'user@example.com';
            updateUserInfo(userName, userEmail);
            
            // 계좌 정보 로드
            loadAccountInfo();
            
            if (loginSuccess === 'success') {
                showWelcomeModal(userName);
            }
        } catch(e) {
            console.error('JWT 파싱 오류:', e);
            updateUserInfo('사용자', 'user@example.com');
        }
    } else {
        showLoggedOutState();
    }
}