# Gateway 기본 설정
server.port=8201
spring.application.name=gateway-service

# Security 비활성화 (Gateway는 라우터 역할만)
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.autoconfigure.security.reactive.ReactiveSecurityAutoConfiguration

# Eureka 설정
eureka.client.service-url.defaultZone=http://localhost:8200/eureka/
eureka.client.fetch-registry=true
eureka.client.register-with-eureka=true

# JWT 설정 (Login Service와 동일하게)
jwt.secret=myBankingSecretKey123456789012345678901234567890
jwt.expiration=86400000
jwt.refresh-expiration=604800000

# Spring Cloud Gateway 라우팅 설정

# 2. 인증 관련 (Login Service)
spring.cloud.gateway.routes[0].id=auth-service
spring.cloud.gateway.routes[0].uri=lb://LOGIN-SERVICE
spring.cloud.gateway.routes[0].predicates[0]=Path=/auth/**,/login/**,/oauth2/**
spring.cloud.gateway.routes[0].filters[0]=RewritePath=/auth/(?<segment>.*), /$\{segment}

# 3. Banking Service API 라우팅
spring.cloud.gateway.routes[1].id=banking-api
spring.cloud.gateway.routes[1].uri=lb://BANKING-SERVICE
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/banking/**
spring.cloud.gateway.routes[1].filters[0]=RewritePath=/api/banking/(?<segment>.*), /$\{segment}

# 4. Banking Service 직접 접근
spring.cloud.gateway.routes[2].id=banking-direct
spring.cloud.gateway.routes[2].uri=lb://BANKING-SERVICE
spring.cloud.gateway.routes[2].predicates[0]=Path=/banking/**


# 5. MyPage Service (나중에 추가)
spring.cloud.gateway.routes[3].id=mypage-service
spring.cloud.gateway.routes[3].uri=lb://MYPAGE-SERVICE
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/mypage/**
spring.cloud.gateway.routes[3].filters[0]=RewritePath=/api/mypage/(?<segment>.*), /$\{segment}

# CORS 설정 (수정됨)
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-origin-patterns=*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-methods=*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allowed-headers=*
spring.cloud.gateway.globalcors.cors-configurations.[/**].allow-credentials=true

# 로깅 설정
logging.level.org.springframework.cloud.gateway=DEBUG
logging.level.org.springframework.web=DEBUG