# Gateway 기본 설정
server.port=8201
spring.application.name=gateway-service

# Eureka 설정
eureka.client.service-url.defaultZone=http://localhost:8200/eureka/
eureka.client.fetch-registry=true
eureka.client.register-with-eureka=true

# Spring Cloud Gateway 라우팅 설정

# 1. 정적 파일 라우팅 (인증 불필요)
spring.cloud.gateway.routes[0].id=static-resources
spring.cloud.gateway.routes[0].uri=lb://BANKING-SERVICE
spring.cloud.gateway.routes[0].predicates[0]=Path=/css/**,/js/**,/images/**

# 2. 인증 관련 (Login Service) - 인증 불필요
spring.cloud.gateway.routes[1].id=auth-service
spring.cloud.gateway.routes[1].uri=lb://LOGIN-SERVICE
spring.cloud.gateway.routes[1].predicates[0]=Path=/auth/**,/login/**,/oauth2/**
spring.cloud.gateway.routes[1].filters[0]=RewritePath=/auth/(?<segment>.*), /$\{segment}

# 3. Banking Service API 라우팅 - JWT 인증 필요
spring.cloud.gateway.routes[2].id=banking-api
spring.cloud.gateway.routes[2].uri=lb://BANKING-SERVICE
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/banking/**
spring.cloud.gateway.routes[2].filters[0]=JwtAuthentication
spring.cloud.gateway.routes[2].filters[1]=RewritePath=/api/banking/(?<segment>.*), /$\{segment}

# 4. Banking Service 직접 접근 - JWT 인증 필요
spring.cloud.gateway.routes[3].id=banking-direct
spring.cloud.gateway.routes[3].uri=lb:lb://BANKING-SERVICE
spring.cloud.gateway.routes[3].predicates[0]=Path=/banking/**
spring.cloud.gateway.routes[3].filters[0]=JwtAuthentication
spring.cloud.gateway.routes[3].filters[1]=RewritePath=/banking/(?<segment>.*), /$\{segment}

# 5. MyPage Service - JWT 인증 필요
spring.cloud.gateway.routes[4].id=mypage-service
spring.cloud.gateway.routes[4].uri=lb://MYPAGE-SERVICE
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/mypage/**
spring.cloud.gateway.routes[4].filters[0]=JwtAuthentication
spring.cloud.gateway.routes[4].filters[1]=RewritePath=/api/mypage/(?<segment>.*), /$\{segment}

# JWT 설정
jwt.secret=myBankingSecretKey123456789012345678901234567890
jwt.expiration=86400000
jwt.refresh-expiration=604800000

# 로그 설정 (디버깅용)
logging.level.com.oww.gateway=DEBUG
logging.level.org.springframework.cloud.gateway=DEBUG